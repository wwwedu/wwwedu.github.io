/* ============================================================
   Quarto notebook: consistent typography + cleaner tables
   Tunables: markdown prose, output size, table size, TOC size
   ============================================================ */

:root{
  --sans: system-ui, -apple-system, "Segoe UI", Roboto, Helvetica, Arial, "Noto Sans", "Liberation Sans", sans-serif;
  --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;

  /* --- font sizes --- */
  --fs-body: 16px;          /* baseline */
  --fs-markdown: 1.05rem;   /* markdown prose */
  --fs-output: 0.65rem;     /* output text (non-code) */
  --fs-table: 0.62rem;      /* table text */
  --fs-toc: 0.62rem;        /* TOC text */
  --fs-code: 0.62rem;       /* code + console */

  /* --- line heights --- */
  --lh-body: 1.55;
  --lh-code: 1.35;

  /* --- colors --- */
  --border: rgba(0,0,0,.12);
  --muted: rgba(0,0,0,.62);
  --bg-soft: rgba(0,0,0,.03);

  --in-bg: rgba(13,110,253,.06);
  --in-bd: rgba(13,110,253,.20);
  --out-bg: rgba(0,0,0,.02);
  --out-bd: rgba(0,0,0,.10);
  --err-bg: rgba(220,53,69,.06);
  --err-bd: rgba(220,53,69,.22);
}

/* Dark mode support */
@media (prefers-color-scheme: dark) {
  :root {
    --border: rgba(255,255,255,.15);
    --muted: rgba(255,255,255,.65);
    --bg-soft: rgba(255,255,255,.05);
    --in-bg: rgba(13,110,253,.12);
    --in-bd: rgba(13,110,253,.30);
    --out-bg: rgba(255,255,255,.03);
    --out-bd: rgba(255,255,255,.12);
    --err-bg: rgba(220,53,69,.12);
    --err-bd: rgba(220,53,69,.30);
  }
}

/* ============================================================
   Global baseline
   ============================================================ */

html{ font-size: var(--fs-body); }

body{
  font-family: var(--sans) !important;
  line-height: var(--lh-body) !important;
  text-rendering: optimizeLegibility;
  -webkit-font-smoothing: antialiased;
  font-variant-numeric: tabular-nums;
}

/* Set a sane default for cell wrappers (do NOT lock markdown here) */
.quarto-cell,
.cell{
  font-family: var(--sans) !important;
  line-height: var(--lh-body) !important;
}

/* Slightly nicer heading rhythm */
h1, h2, h3 { letter-spacing: -0.01em; }
h2 { margin-top: 1.6rem; }

/* ============================================================
   Inline code + code blocks
   ============================================================ */

code{
  font-family: var(--mono) !important;
  font-size: var(--fs-code) !important;
}

pre, pre code,
div.sourceCode pre, .sourceCode,
pre code.hljs, .hljs,
.cm-editor, .cm-scroller, .cm-content, .cm-line{
  font-family: var(--mono) !important;
  font-size: var(--fs-code) !important;
  line-height: var(--lh-code) !important;
}

pre{
  background: var(--bg-soft) !important;
  border: 1px solid var(--border) !important;
  border-radius: 8px;
  padding: 0.75rem 0.9rem !important;
}

/* ============================================================
   Markdown cell formatting (PROSE SIZE SOURCE OF TRUTH)
   ============================================================ */

/* Strong selector + !important so it always wins */
.quarto-cell .cell-markdown,
.cell .cell-markdown,
.cell-markdown{
  font-size: var(--fs-markdown) !important;
  line-height: 1.6 !important;
}

.cell-markdown p{ margin: 0.8rem 0; }
.cell-markdown p:first-child{ margin-top: 0; }

.cell-markdown ul, .cell-markdown ol{
  margin: 0.6rem 0;
  padding-left: 1.5rem;
}
.cell-markdown li{ margin: 0.3rem 0; }

.cell-markdown blockquote{
  border-left: 4px solid var(--border);
  padding-left: 1rem;
  margin: 1rem 0;
  color: var(--muted);
  font-style: italic;
}

/* Headings inside markdown */
.cell-markdown h1 { font-size: 1.9rem; }
.cell-markdown h2 { font-size: 1.55rem; }
.cell-markdown h3 { font-size: 1.25rem; }

/* ============================================================
   MathJax: inline math inherits markdown size
   ============================================================ */

mjx-container{
  font-size: inherit !important; /* key */
  line-height: 1.4;
}

/* inline math */
mjx-container[jax="CHTML"][display="false"]{
  font-size: inherit !important;
}

/* display math spacing only */
mjx-container[jax="CHTML"][display="true"]{
  margin: 1.1rem 0 1.3rem 0 !important;
}

/* math font */
mjx-math{
  font-family: "STIX Two Math", "STIXGeneral", "Latin Modern Math",
               "Cambria Math", serif !important;
  font-weight: normal;
}
mjx-math *{ color: inherit; }

/* ============================================================
   Output sizing (smaller tables / printed output)
   ============================================================ */

.cell-output,
.cell-output-display,
.cell-output-stdout,
.cell-output-stderr{
  font-family: var(--sans) !important;
  font-size: var(--fs-output) !important;
  line-height: 1.45 !important;
}

/* Let descendants inherit output baseline */
.cell-output *{
  font-family: inherit;
  font-size: inherit;
  line-height: inherit;
}

/* Keep console/code output monospace + code size */
.cell-output pre,
.cell-output-display pre,
.cell-output-stdout pre,
.cell-output-stderr pre{
  font-family: var(--mono) !important;
  font-size: var(--fs-code) !important;
  line-height: var(--lh-code) !important;
}

/* tibble/pandas preface line: slightly muted + small */
.cell-output-display > p,
.cell-output-display p{
  color: var(--muted);
  font-size: 0.90rem !important;
  margin: 0.35rem 0 0.5rem 0 !important;
}

/* Tables */
.cell-output table,
.cell-output table *{
  font-family: var(--sans) !important;
  font-size: var(--fs-table) !important;
  line-height: 1.32 !important;
}

/* pandas hook */
table.dataframe,
table.dataframe *{
  font-family: var(--sans) !important;
  font-size: var(--fs-table) !important;
  line-height: 1.32 !important;
}

.cell-output table{
  border-collapse: collapse !important;
  border: 1px solid var(--border) !important;
  border-radius: 10px;
  overflow: hidden;
  background: white !important;
  margin: 0.5rem 0 1rem 0;
  width: auto;
  max-width: fit-content;
  min-width: 300px;
}

.cell-output thead th{
  background: rgba(0,0,0,.05);
  border-bottom: 1px solid var(--border) !important;
  font-weight: 600;
  white-space: nowrap;
}

.cell-output th, .cell-output td{
  padding: 0.30rem 0.50rem !important;
  border-bottom: 1px solid rgba(0,0,0,.06) !important;
  vertical-align: top;
}

.cell-output tbody tr:nth-child(even){
  background: rgba(0,0,0,.02);
}

/* Horizontal scrolling for wide outputs */
.cell-output,
.cell-output-display{
  overflow-x: auto;
  max-width: 100%;
}

/* ============================================================
   Differentiate code INPUT vs OUTPUT
   ============================================================ */

/* INPUT */
.cell-input pre,
.cell-input div.sourceCode pre,
.cell-input pre code,
.cell-input .sourceCode{
  background: var(--in-bg) !important;
  border: 1px solid var(--in-bd) !important;
  border-left: 4px solid rgba(13,110,253,.35) !important;
  border-radius: 10px !important;
}

/* OUTPUT code blocks */
.cell-output pre,
.cell-output-display pre{
  background: var(--out-bg) !important;
  border: 1px solid var(--out-bd) !important;
  border-left: 4px solid rgba(0,0,0,.12) !important;
  border-radius: 10px !important;
}

/* STDERR */
.cell-output-stderr pre{
  background: var(--err-bg) !important;
  border: 1px solid var(--err-bd) !important;
  border-left: 4px solid rgba(220,53,69,.45) !important;
}

/* Output label */
.cell-output::before{
  content: "Out";
  display: block;
  font-family: var(--sans);
  font-size: 0.80rem;
  font-weight: 500;
  color: rgba(0,0,0,.55);
  margin-bottom: 0.35rem;
}

/* ============================================================
   TOC (Quarto sidebar + legacy #TOC)
   ============================================================ */

/* Legacy / some templates */
#TOC, #TOC *{
  font-family: var(--sans) !important;
  font-size: var(--fs-toc) !important;
  line-height: 1.4 !important;
}

/* Quarto sidebar TOC (Bootstrap sidebar nav) */
.sidebar nav,
.sidebar nav *,
.quarto-sidebar nav,
.quarto-sidebar nav *,
#quarto-sidebar nav,
#quarto-sidebar nav *,
nav#TOC,
nav#TOC *{
  font-family: var(--sans) !important;
  font-size: var(--fs-toc) !important;
  line-height: 1.4 !important;
}

/* Slight hierarchy by depth */
.sidebar nav ul ul,
.quarto-sidebar nav ul ul,
#quarto-sidebar nav ul ul{
  font-size: 0.95em !important;
}
.sidebar nav ul ul ul,
.quarto-sidebar nav ul ul ul,
#quarto-sidebar nav ul ul ul{
  font-size: 0.92em !important;
}

/* ============================================================
   Interactive outputs (Plotly, widgets)
   ============================================================ */

.cell-output .plotly,
.cell-output .widget-output,
.cell-output .jp-OutputArea-output{
  background: white !important;
  border: 1px solid var(--border) !important;
  border-radius: 10px;
  padding: 1rem;
  margin: 0.5rem 0;
}

/* Images */
.cell-output img{
  max-width: 100%;
  height: auto;
  border-radius: 8px;
  margin: 0.5rem 0;
  display: block;
}

/* ============================================================
   Print optimization
   ============================================================ */

@media print {
  .cell-output::before { display: none; }
  pre { page-break-inside: avoid; }
  table { page-break-inside: avoid; }
}
