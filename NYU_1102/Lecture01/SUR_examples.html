<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Dragos Ailoae">

<title>Seemingly Unrelated Regression (SUR)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="SUR_examples_files/libs/clipboard/clipboard.min.js"></script>
<script src="SUR_examples_files/libs/quarto-html/quarto.js"></script>
<script src="SUR_examples_files/libs/quarto-html/popper.min.js"></script>
<script src="SUR_examples_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="SUR_examples_files/libs/quarto-html/anchor.min.js"></script>
<link href="SUR_examples_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="SUR_examples_files/libs/quarto-html/quarto-syntax-highlighting-de84f8d6bb715db06a919283c2d1e787.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="SUR_examples_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="SUR_examples_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="SUR_examples_files/libs/bootstrap/bootstrap-cf43a150f4ed865b4eb4d60b88c21c49.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<link href="SUR_examples_files/libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">

<script src="SUR_examples_files/libs/pagedtable-1.1/js/pagedtable.js"></script>


  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-full toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#what-this-notebook-covers" id="toc-what-this-notebook-covers" class="nav-link active" data-scroll-target="#what-this-notebook-covers">What This Notebook Covers</a></li>
  <li><a href="#introduction-what-is-sur" id="toc-introduction-what-is-sur" class="nav-link" data-scroll-target="#introduction-what-is-sur"><span class="header-section-number">1</span> Introduction: What is SUR?</a>
  <ul class="collapse">
  <li><a href="#key-intuition" id="toc-key-intuition" class="nav-link" data-scroll-target="#key-intuition"><span class="header-section-number">1.1</span> Key Intuition</a></li>
  <li><a href="#when-to-use-sur" id="toc-when-to-use-sur" class="nav-link" data-scroll-target="#when-to-use-sur"><span class="header-section-number">1.2</span> When to Use SUR</a></li>
  </ul></li>
  <li><a href="#the-grunfeld-investment-dataset" id="toc-the-grunfeld-investment-dataset" class="nav-link" data-scroll-target="#the-grunfeld-investment-dataset"><span class="header-section-number">2</span> The Grunfeld Investment Dataset</a>
  <ul class="collapse">
  <li><a href="#the-investment-model" id="toc-the-investment-model" class="nav-link" data-scroll-target="#the-investment-model"><span class="header-section-number">2.1</span> The Investment Model</a></li>
  <li><a href="#why-these-two-firms" id="toc-why-these-two-firms" class="nav-link" data-scroll-target="#why-these-two-firms"><span class="header-section-number">2.2</span> Why These Two Firms?</a></li>
  </ul></li>
  <li><a href="#setup-and-data-loading" id="toc-setup-and-data-loading" class="nav-link" data-scroll-target="#setup-and-data-loading"><span class="header-section-number">3</span> Setup and Data Loading</a>
  <ul class="collapse">
  <li><a href="#load-required-packages" id="toc-load-required-packages" class="nav-link" data-scroll-target="#load-required-packages"><span class="header-section-number">3.1</span> Load Required Packages</a></li>
  <li><a href="#load-and-inspect-the-data" id="toc-load-and-inspect-the-data" class="nav-link" data-scroll-target="#load-and-inspect-the-data"><span class="header-section-number">3.2</span> Load and Inspect the Data</a></li>
  </ul></li>
  <li><a href="#equation-by-equation-ols-estimation" id="toc-equation-by-equation-ols-estimation" class="nav-link" data-scroll-target="#equation-by-equation-ols-estimation"><span class="header-section-number">4</span> Equation-by-Equation OLS Estimation</a>
  <ul class="collapse">
  <li><a href="#split-data-by-firm" id="toc-split-data-by-firm" class="nav-link" data-scroll-target="#split-data-by-firm"><span class="header-section-number">4.1</span> Split Data by Firm</a></li>
  <li><a href="#estimate-us-steel-investment" id="toc-estimate-us-steel-investment" class="nav-link" data-scroll-target="#estimate-us-steel-investment"><span class="header-section-number">4.2</span> Estimate US Steel Investment</a></li>
  <li><a href="#estimate-diamond-match-investment" id="toc-estimate-diamond-match-investment" class="nav-link" data-scroll-target="#estimate-diamond-match-investment"><span class="header-section-number">4.3</span> Estimate Diamond Match Investment</a></li>
  </ul></li>
  <li><a href="#the-case-for-sur-examining-residual-correlation" id="toc-the-case-for-sur-examining-residual-correlation" class="nav-link" data-scroll-target="#the-case-for-sur-examining-residual-correlation"><span class="header-section-number">5</span> The Case for SUR: Examining Residual Correlation</a>
  <ul class="collapse">
  <li><a href="#visual-inspection-of-residuals" id="toc-visual-inspection-of-residuals" class="nav-link" data-scroll-target="#visual-inspection-of-residuals"><span class="header-section-number">5.1</span> Visual Inspection of Residuals</a></li>
  <li><a href="#scatter-plot-of-residuals" id="toc-scatter-plot-of-residuals" class="nav-link" data-scroll-target="#scatter-plot-of-residuals"><span class="header-section-number">5.2</span> Scatter Plot of Residuals</a></li>
  </ul></li>
  <li><a href="#panel-data-configuration" id="toc-panel-data-configuration" class="nav-link" data-scroll-target="#panel-data-configuration"><span class="header-section-number">6</span> Panel Data Configuration</a></li>
  <li><a href="#alternative-methods-for-equation-by-equation-estimation" id="toc-alternative-methods-for-equation-by-equation-estimation" class="nav-link" data-scroll-target="#alternative-methods-for-equation-by-equation-estimation"><span class="header-section-number">7</span> Alternative Methods for Equation-by-Equation Estimation</a>
  <ul class="collapse">
  <li><a href="#using-plm-package" id="toc-using-plm-package" class="nav-link" data-scroll-target="#using-plm-package"><span class="header-section-number">7.1</span> Using PLM Package</a></li>
  <li><a href="#using-systemfit-package" id="toc-using-systemfit-package" class="nav-link" data-scroll-target="#using-systemfit-package"><span class="header-section-number">7.2</span> Using SYSTEMFIT Package</a></li>
  <li><a href="#manual-calculation-understanding-the-math" id="toc-manual-calculation-understanding-the-math" class="nav-link" data-scroll-target="#manual-calculation-understanding-the-math"><span class="header-section-number">7.3</span> Manual Calculation: Understanding the Math</a></li>
  </ul></li>
  <li><a href="#testing-for-cross-sectional-dependence" id="toc-testing-for-cross-sectional-dependence" class="nav-link" data-scroll-target="#testing-for-cross-sectional-dependence"><span class="header-section-number">8</span> Testing for Cross-Sectional Dependence</a>
  <ul class="collapse">
  <li><a href="#examining-the-covariance-matrix" id="toc-examining-the-covariance-matrix" class="nav-link" data-scroll-target="#examining-the-covariance-matrix"><span class="header-section-number">8.1</span> Examining the Covariance Matrix</a></li>
  <li><a href="#kronecker-product-and-full-error-covariance" id="toc-kronecker-product-and-full-error-covariance" class="nav-link" data-scroll-target="#kronecker-product-and-full-error-covariance"><span class="header-section-number">8.2</span> Kronecker Product and Full Error Covariance</a></li>
  <li><a href="#formal-tests-for-cross-sectional-dependence" id="toc-formal-tests-for-cross-sectional-dependence" class="nav-link" data-scroll-target="#formal-tests-for-cross-sectional-dependence"><span class="header-section-number">8.3</span> Formal Tests for Cross-Sectional Dependence</a>
  <ul class="collapse">
  <li><a href="#breusch-pagan-lm-test" id="toc-breusch-pagan-lm-test" class="nav-link" data-scroll-target="#breusch-pagan-lm-test"><span class="header-section-number">8.3.1</span> Breusch-Pagan LM Test</a></li>
  <li><a href="#pesaran-cd-test" id="toc-pesaran-cd-test" class="nav-link" data-scroll-target="#pesaran-cd-test"><span class="header-section-number">8.3.2</span> Pesaran CD Test</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#seemingly-unrelated-regression-sur-estimation" id="toc-seemingly-unrelated-regression-sur-estimation" class="nav-link" data-scroll-target="#seemingly-unrelated-regression-sur-estimation"><span class="header-section-number">9</span> Seemingly Unrelated Regression (SUR) Estimation</a>
  <ul class="collapse">
  <li><a href="#comparing-ols-vs-sur-results" id="toc-comparing-ols-vs-sur-results" class="nav-link" data-scroll-target="#comparing-ols-vs-sur-results"><span class="header-section-number">9.1</span> Comparing OLS vs SUR Results</a></li>
  <li><a href="#efficiency-gains" id="toc-efficiency-gains" class="nav-link" data-scroll-target="#efficiency-gains"><span class="header-section-number">9.2</span> Efficiency Gains</a></li>
  </ul></li>
  <li><a href="#testing-for-coefficient-homogeneity" id="toc-testing-for-coefficient-homogeneity" class="nav-link" data-scroll-target="#testing-for-coefficient-homogeneity"><span class="header-section-number">10</span> Testing for Coefficient Homogeneity</a>
  <ul class="collapse">
  <li><a href="#pooled-ols-model" id="toc-pooled-ols-model" class="nav-link" data-scroll-target="#pooled-ols-model"><span class="header-section-number">10.1</span> Pooled OLS Model</a></li>
  <li><a href="#chow-test-for-poolability" id="toc-chow-test-for-poolability" class="nav-link" data-scroll-target="#chow-test-for-poolability"><span class="header-section-number">10.2</span> Chow Test for Poolability</a></li>
  </ul></li>
  <li><a href="#summary-and-key-takeaways" id="toc-summary-and-key-takeaways" class="nav-link" data-scroll-target="#summary-and-key-takeaways"><span class="header-section-number">11</span> Summary and Key Takeaways</a>
  <ul class="collapse">
  <li><a href="#what-we-learned" id="toc-what-we-learned" class="nav-link" data-scroll-target="#what-we-learned"><span class="header-section-number">11.1</span> What We Learned</a></li>
  <li><a href="#when-to-use-sur-vs-alternatives" id="toc-when-to-use-sur-vs-alternatives" class="nav-link" data-scroll-target="#when-to-use-sur-vs-alternatives"><span class="header-section-number">11.2</span> When to Use SUR vs Alternatives</a></li>
  <li><a href="#the-sur-advantage" id="toc-the-sur-advantage" class="nav-link" data-scroll-target="#the-sur-advantage"><span class="header-section-number">11.3</span> The SUR Advantage</a></li>
  <li><a href="#practical-recommendations" id="toc-practical-recommendations" class="nav-link" data-scroll-target="#practical-recommendations"><span class="header-section-number">11.4</span> Practical Recommendations</a></li>
  </ul></li>
  <li><a href="#further-reading-and-resources" id="toc-further-reading-and-resources" class="nav-link" data-scroll-target="#further-reading-and-resources"><span class="header-section-number">12</span> Further Reading and Resources</a></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
</div>
<main class="content column-page-right" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Seemingly Unrelated Regression (SUR)</h1>
<p class="subtitle lead">Theory, Intuition, and Application to the Grunfeld Dataset<br>NYU - Applied Statistics and Econometrics 2</p>
</div>



<div class="quarto-title-meta column-page-right">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Dragos Ailoae </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<section id="what-this-notebook-covers" class="level1 unnumbered">
<h1 class="unnumbered">What This Notebook Covers</h1>
<p>This notebook explores <strong>Seemingly Unrelated Regression (SUR)</strong>, a technique for estimating multiple regression equations simultaneously when their error terms are correlated. We’ll walk through the motivation for SUR, show when and why it’s useful, and demonstrate how to implement it in R using the classic Grunfeld investment dataset.</p>
<p>Along the way, we’ll cover how to test for cross-sectional dependence, compare the efficiency gains of SUR versus standard OLS, and interpret the results in the context of investment decisions by firms facing common macroeconomic shocks.</p>
<hr>
</section>
<section id="introduction-what-is-sur" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Introduction: What is SUR?</h1>
<p><strong>Seemingly Unrelated Regression (SUR)</strong> is a generalization of linear regression that allows us to estimate a system of equations simultaneously. The equations appear “unrelated” because they involve different dependent variables, but they become “related” through contemporaneously correlated error terms.</p>
<section id="key-intuition" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="key-intuition"><span class="header-section-number">1.1</span> Key Intuition</h2>
<p>Imagine you’re modeling investment decisions for two firms. Even though each firm makes independent investment decisions, both might be affected by the same macroeconomic shocks (e.g., interest rate changes, oil price shocks, or policy changes). These common shocks create correlation between the error terms in the two regression equations.</p>
<p><strong>Why does this matter?</strong> If we estimate each equation separately using OLS, we ignore this correlation and lose efficiency. SUR estimation accounts for this correlation structure, producing more efficient estimators with lower standard errors.</p>
</section>
<section id="when-to-use-sur" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="when-to-use-sur"><span class="header-section-number">1.2</span> When to Use SUR</h2>
<p>SUR is particularly useful when:</p>
<ul>
<li>You have multiple related equations with different dependent variables</li>
<li>The equations share similar regressors but have different coefficients</li>
<li>You suspect contemporaneous correlation in the disturbances</li>
<li>You want more efficient estimates than equation-by-equation OLS</li>
</ul>
<p><strong>Mathematical Setup:</strong> For <span class="math inline">\(M\)</span> equations observed over <span class="math inline">\(T\)</span> time periods:</p>
<p><span class="math display">\[
\begin{aligned}
y_{1t} &amp;= X_{1t}\beta_1 + \epsilon_{1t} \\
y_{2t} &amp;= X_{2t}\beta_2 + \epsilon_{2t} \\
&amp;\vdots \\
y_{Mt} &amp;= X_{Mt}\beta_M + \epsilon_{Mt}
\end{aligned}
\]</span></p>
<p>The key assumption is: <span class="math inline">\(E[\epsilon_{it}\epsilon_{jt}] = \sigma_{ij} \neq 0\)</span> (contemporaneous correlation)</p>
<hr>
</section>
</section>
<section id="the-grunfeld-investment-dataset" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> The Grunfeld Investment Dataset</h1>
<p>We’ll use the famous Grunfeld dataset to illustrate SUR estimation. This dataset was popularized by Arnold Zellner in his seminal 1962 paper on seemingly unrelated regressions. Grunfeld originally collected the data for his 1958 PhD thesis at the University of Chicago on the determinants of corporate investment.</p>
<section id="the-investment-model" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="the-investment-model"><span class="header-section-number">2.1</span> The Investment Model</h2>
<p>The Grunfeld model relates a firm’s gross investment to its market value and capital stock:</p>
<p><span class="math display">\[
\text{inv}_{it} = \beta_{0i} + \beta_{1i} \text{val}_{it} + \beta_{2i} \text{cap}_{it} + \epsilon_{it}
\]</span></p>
<p>where:</p>
<ul>
<li><span class="math inline">\(\text{inv}_{it}\)</span> = gross investment for firm <span class="math inline">\(i\)</span> at time <span class="math inline">\(t\)</span></li>
<li><span class="math inline">\(\text{val}_{it}\)</span> = market value of firm <span class="math inline">\(i\)</span> at time <span class="math inline">\(t\)</span></li>
<li><span class="math inline">\(\text{cap}_{it}\)</span> = capital stock of firm <span class="math inline">\(i\)</span> at time <span class="math inline">\(t\)</span></li>
</ul>
<p><strong>Our subset</strong> focuses on two firms:</p>
<ul>
<li><strong>US</strong>: United States Steel Corporation</li>
<li><strong>DM</strong>: Diamond Match Company</li>
</ul>
<p>Both observed annually from 1935 to 1954 (20 years).</p>
</section>
<section id="why-these-two-firms" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="why-these-two-firms"><span class="header-section-number">2.2</span> Why These Two Firms?</h2>
<p>While these firms operated in different industries (steel vs.&nbsp;consumer goods), they both faced similar macroeconomic conditions during the pre-war, wartime, and post-war periods. This makes them ideal candidates for SUR estimation.</p>
<p><strong>Additional Resources:</strong></p>
<ul>
<li><a href="http://www.stern.nyu.edu/~wgreene/Text/Edition7/TableF10-4.csv">Full Grunfeld dataset - NYU</a></li>
<li><a href="https://www.zeileis.org/grunfeld/">Alternative source with documentation</a></li>
</ul>
<hr>
</section>
</section>
<section id="setup-and-data-loading" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Setup and Data Loading</h1>
<section id="load-required-packages" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="load-required-packages"><span class="header-section-number">3.1</span> Load Required Packages</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Clear workspace (use with caution!)</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Set plotting options</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">repr.plot.width =</span> <span class="dv">8</span>, </span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">repr.plot.height =</span> <span class="dv">6</span>,</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">repr.plot.res =</span> <span class="dv">150</span>, </span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">warn =</span> <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Required packages for SUR analysis</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>packages <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>  <span class="st">"plm"</span>,           <span class="co"># Panel Linear Models</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>  <span class="st">"systemfit"</span>,     <span class="co"># System of equations estimation</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>  <span class="st">"modelsummary"</span>,  <span class="co"># Beautiful regression tables</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>  <span class="st">"ggplot2"</span>,       <span class="co"># Enhanced graphics</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>  <span class="st">"knitr"</span>          <span class="co"># Table formatting</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Install packages if needed, then load them</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="fu">lapply</span>(packages, <span class="cf">function</span>(pkg) {</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(pkg, <span class="at">character.only =</span> <span class="cn">TRUE</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">install.packages</span>(pkg)</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">require</span>(pkg, <span class="at">character.only =</span> <span class="cn">TRUE</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>}))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="load-and-inspect-the-data" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="load-and-inspect-the-data"><span class="header-section-number">3.2</span> Load and Inspect the Data</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load data from online source</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>my.raw.data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">url</span>(<span class="st">"https://wwwedu.github.io/NYU_1102/Lecture01/grun_data.csv"</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the data</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>  my.raw.data,</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">format =</span> <span class="st">"pipe"</span>,</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">digits =</span> <span class="dv">2</span>,</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">caption =</span> <span class="st">"Table 1: Grunfeld Investment Data (US Steel and Diamond Match, 1935-1954)"</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Table 1: Grunfeld Investment Data (US Steel and Diamond Match, 1935-1954)</caption>
<thead>
<tr class="header">
<th style="text-align: left;">firm</th>
<th style="text-align: right;">year</th>
<th style="text-align: right;">inv</th>
<th style="text-align: right;">val</th>
<th style="text-align: right;">cap</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">US</td>
<td style="text-align: right;">1935</td>
<td style="text-align: right;">209.90</td>
<td style="text-align: right;">1362.40</td>
<td style="text-align: right;">53.80</td>
</tr>
<tr class="even">
<td style="text-align: left;">US</td>
<td style="text-align: right;">1936</td>
<td style="text-align: right;">355.30</td>
<td style="text-align: right;">1807.10</td>
<td style="text-align: right;">50.50</td>
</tr>
<tr class="odd">
<td style="text-align: left;">US</td>
<td style="text-align: right;">1937</td>
<td style="text-align: right;">469.90</td>
<td style="text-align: right;">2676.30</td>
<td style="text-align: right;">118.10</td>
</tr>
<tr class="even">
<td style="text-align: left;">US</td>
<td style="text-align: right;">1938</td>
<td style="text-align: right;">262.30</td>
<td style="text-align: right;">1801.90</td>
<td style="text-align: right;">260.20</td>
</tr>
<tr class="odd">
<td style="text-align: left;">US</td>
<td style="text-align: right;">1939</td>
<td style="text-align: right;">230.40</td>
<td style="text-align: right;">1957.30</td>
<td style="text-align: right;">312.70</td>
</tr>
<tr class="even">
<td style="text-align: left;">US</td>
<td style="text-align: right;">1940</td>
<td style="text-align: right;">361.60</td>
<td style="text-align: right;">2202.90</td>
<td style="text-align: right;">254.20</td>
</tr>
<tr class="odd">
<td style="text-align: left;">US</td>
<td style="text-align: right;">1941</td>
<td style="text-align: right;">472.80</td>
<td style="text-align: right;">2380.50</td>
<td style="text-align: right;">261.40</td>
</tr>
<tr class="even">
<td style="text-align: left;">US</td>
<td style="text-align: right;">1942</td>
<td style="text-align: right;">445.60</td>
<td style="text-align: right;">2168.60</td>
<td style="text-align: right;">298.70</td>
</tr>
<tr class="odd">
<td style="text-align: left;">US</td>
<td style="text-align: right;">1943</td>
<td style="text-align: right;">361.60</td>
<td style="text-align: right;">1985.10</td>
<td style="text-align: right;">301.80</td>
</tr>
<tr class="even">
<td style="text-align: left;">US</td>
<td style="text-align: right;">1944</td>
<td style="text-align: right;">288.20</td>
<td style="text-align: right;">1813.90</td>
<td style="text-align: right;">279.10</td>
</tr>
<tr class="odd">
<td style="text-align: left;">US</td>
<td style="text-align: right;">1945</td>
<td style="text-align: right;">258.70</td>
<td style="text-align: right;">1850.20</td>
<td style="text-align: right;">213.80</td>
</tr>
<tr class="even">
<td style="text-align: left;">US</td>
<td style="text-align: right;">1946</td>
<td style="text-align: right;">420.30</td>
<td style="text-align: right;">2067.70</td>
<td style="text-align: right;">132.60</td>
</tr>
<tr class="odd">
<td style="text-align: left;">US</td>
<td style="text-align: right;">1947</td>
<td style="text-align: right;">420.50</td>
<td style="text-align: right;">1796.70</td>
<td style="text-align: right;">264.80</td>
</tr>
<tr class="even">
<td style="text-align: left;">US</td>
<td style="text-align: right;">1948</td>
<td style="text-align: right;">494.50</td>
<td style="text-align: right;">1625.80</td>
<td style="text-align: right;">306.90</td>
</tr>
<tr class="odd">
<td style="text-align: left;">US</td>
<td style="text-align: right;">1949</td>
<td style="text-align: right;">405.10</td>
<td style="text-align: right;">1667.00</td>
<td style="text-align: right;">351.10</td>
</tr>
<tr class="even">
<td style="text-align: left;">US</td>
<td style="text-align: right;">1950</td>
<td style="text-align: right;">418.80</td>
<td style="text-align: right;">1677.40</td>
<td style="text-align: right;">357.80</td>
</tr>
<tr class="odd">
<td style="text-align: left;">US</td>
<td style="text-align: right;">1951</td>
<td style="text-align: right;">588.20</td>
<td style="text-align: right;">2289.50</td>
<td style="text-align: right;">342.10</td>
</tr>
<tr class="even">
<td style="text-align: left;">US</td>
<td style="text-align: right;">1952</td>
<td style="text-align: right;">645.50</td>
<td style="text-align: right;">2159.40</td>
<td style="text-align: right;">444.20</td>
</tr>
<tr class="odd">
<td style="text-align: left;">US</td>
<td style="text-align: right;">1953</td>
<td style="text-align: right;">641.00</td>
<td style="text-align: right;">2031.30</td>
<td style="text-align: right;">623.60</td>
</tr>
<tr class="even">
<td style="text-align: left;">US</td>
<td style="text-align: right;">1954</td>
<td style="text-align: right;">459.30</td>
<td style="text-align: right;">2115.50</td>
<td style="text-align: right;">669.70</td>
</tr>
<tr class="odd">
<td style="text-align: left;">DM</td>
<td style="text-align: right;">1935</td>
<td style="text-align: right;">2.54</td>
<td style="text-align: right;">70.91</td>
<td style="text-align: right;">4.50</td>
</tr>
<tr class="even">
<td style="text-align: left;">DM</td>
<td style="text-align: right;">1936</td>
<td style="text-align: right;">2.00</td>
<td style="text-align: right;">87.94</td>
<td style="text-align: right;">4.71</td>
</tr>
<tr class="odd">
<td style="text-align: left;">DM</td>
<td style="text-align: right;">1937</td>
<td style="text-align: right;">2.19</td>
<td style="text-align: right;">82.20</td>
<td style="text-align: right;">4.57</td>
</tr>
<tr class="even">
<td style="text-align: left;">DM</td>
<td style="text-align: right;">1938</td>
<td style="text-align: right;">1.99</td>
<td style="text-align: right;">58.72</td>
<td style="text-align: right;">4.56</td>
</tr>
<tr class="odd">
<td style="text-align: left;">DM</td>
<td style="text-align: right;">1939</td>
<td style="text-align: right;">2.03</td>
<td style="text-align: right;">80.54</td>
<td style="text-align: right;">4.38</td>
</tr>
<tr class="even">
<td style="text-align: left;">DM</td>
<td style="text-align: right;">1940</td>
<td style="text-align: right;">1.81</td>
<td style="text-align: right;">86.47</td>
<td style="text-align: right;">4.21</td>
</tr>
<tr class="odd">
<td style="text-align: left;">DM</td>
<td style="text-align: right;">1941</td>
<td style="text-align: right;">2.14</td>
<td style="text-align: right;">77.68</td>
<td style="text-align: right;">4.12</td>
</tr>
<tr class="even">
<td style="text-align: left;">DM</td>
<td style="text-align: right;">1942</td>
<td style="text-align: right;">1.86</td>
<td style="text-align: right;">62.16</td>
<td style="text-align: right;">3.83</td>
</tr>
<tr class="odd">
<td style="text-align: left;">DM</td>
<td style="text-align: right;">1943</td>
<td style="text-align: right;">0.93</td>
<td style="text-align: right;">62.24</td>
<td style="text-align: right;">3.58</td>
</tr>
<tr class="even">
<td style="text-align: left;">DM</td>
<td style="text-align: right;">1944</td>
<td style="text-align: right;">1.18</td>
<td style="text-align: right;">61.82</td>
<td style="text-align: right;">3.41</td>
</tr>
<tr class="odd">
<td style="text-align: left;">DM</td>
<td style="text-align: right;">1945</td>
<td style="text-align: right;">1.36</td>
<td style="text-align: right;">65.85</td>
<td style="text-align: right;">3.31</td>
</tr>
<tr class="even">
<td style="text-align: left;">DM</td>
<td style="text-align: right;">1946</td>
<td style="text-align: right;">2.24</td>
<td style="text-align: right;">69.54</td>
<td style="text-align: right;">3.23</td>
</tr>
<tr class="odd">
<td style="text-align: left;">DM</td>
<td style="text-align: right;">1947</td>
<td style="text-align: right;">3.81</td>
<td style="text-align: right;">64.97</td>
<td style="text-align: right;">3.90</td>
</tr>
<tr class="even">
<td style="text-align: left;">DM</td>
<td style="text-align: right;">1948</td>
<td style="text-align: right;">5.66</td>
<td style="text-align: right;">68.00</td>
<td style="text-align: right;">5.38</td>
</tr>
<tr class="odd">
<td style="text-align: left;">DM</td>
<td style="text-align: right;">1949</td>
<td style="text-align: right;">4.21</td>
<td style="text-align: right;">71.24</td>
<td style="text-align: right;">7.39</td>
</tr>
<tr class="even">
<td style="text-align: left;">DM</td>
<td style="text-align: right;">1950</td>
<td style="text-align: right;">3.42</td>
<td style="text-align: right;">69.05</td>
<td style="text-align: right;">8.74</td>
</tr>
<tr class="odd">
<td style="text-align: left;">DM</td>
<td style="text-align: right;">1951</td>
<td style="text-align: right;">4.67</td>
<td style="text-align: right;">83.04</td>
<td style="text-align: right;">9.07</td>
</tr>
<tr class="even">
<td style="text-align: left;">DM</td>
<td style="text-align: right;">1952</td>
<td style="text-align: right;">6.00</td>
<td style="text-align: right;">74.42</td>
<td style="text-align: right;">9.93</td>
</tr>
<tr class="odd">
<td style="text-align: left;">DM</td>
<td style="text-align: right;">1953</td>
<td style="text-align: right;">6.53</td>
<td style="text-align: right;">63.51</td>
<td style="text-align: right;">11.68</td>
</tr>
<tr class="even">
<td style="text-align: left;">DM</td>
<td style="text-align: right;">1954</td>
<td style="text-align: right;">5.12</td>
<td style="text-align: right;">58.12</td>
<td style="text-align: right;">14.33</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary statistics</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(my.raw.data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     firm                year           inv               val         
 Length:40          Min.   :1935   Min.   :  0.930   Min.   :  58.12  
 Class :character   1st Qu.:1940   1st Qu.:  2.228   1st Qu.:  69.42  
 Mode  :character   Median :1944   Median :108.215   Median : 725.17  
                    Mean   :1944   Mean   :206.780   Mean   :1021.37  
                    3rd Qu.:1949   3rd Qu.:419.175   3rd Qu.:1964.25  
                    Max.   :1954   Max.   :645.500   Max.   :2676.30  
      cap         
 Min.   :  3.230  
 1st Qu.:  4.545  
 Median : 32.415  
 Mean   :150.398  
 3rd Qu.:284.000  
 Max.   :669.700  </code></pre>
</div>
</div>
<hr>
</section>
</section>
<section id="equation-by-equation-ols-estimation" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Equation-by-Equation OLS Estimation</h1>
<p>As a baseline, let’s estimate each firm’s investment equation separately using ordinary least squares (OLS). This ignores any potential correlation between the firms’ disturbances.</p>
<section id="split-data-by-firm" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="split-data-by-firm"><span class="header-section-number">4.1</span> Split Data by Firm</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Subset data for each firm</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>US.data <span class="ot">&lt;-</span> <span class="fu">subset</span>(my.raw.data, firm <span class="sc">==</span> <span class="st">"US"</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>DM.data <span class="ot">&lt;-</span> <span class="fu">subset</span>(my.raw.data, firm <span class="sc">==</span> <span class="st">"DM"</span>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"US Steel observations:"</span>, <span class="fu">nrow</span>(US.data), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>US Steel observations: 20 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Diamond Match observations:"</span>, <span class="fu">nrow</span>(DM.data), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Diamond Match observations: 20 </code></pre>
</div>
</div>
</section>
<section id="estimate-us-steel-investment" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="estimate-us-steel-investment"><span class="header-section-number">4.2</span> Estimate US Steel Investment</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>lm.US <span class="ot">&lt;-</span> <span class="fu">lm</span>(inv <span class="sc">~</span> val <span class="sc">+</span> cap, <span class="at">data =</span> US.data)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm.US)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = inv ~ val + cap, data = US.data)

Residuals:
     Min       1Q   Median       3Q      Max 
-184.488  -77.210    4.508   59.421  144.035 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)  
(Intercept) -49.1983   148.0754  -0.332   0.7438  
val           0.1749     0.0742   2.357   0.0307 *
cap           0.3896     0.1424   2.737   0.0140 *
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 96.43 on 17 degrees of freedom
Multiple R-squared:  0.4709,    Adjusted R-squared:  0.4086 
F-statistic: 7.564 on 2 and 17 DF,  p-value: 0.00447</code></pre>
</div>
</div>
<p><strong>Interpretation (US Steel):</strong></p>
<ul>
<li><strong>Value coefficient</strong>: For every unit increase in market value, investment increases by 0.175</li>
<li><strong>Capital coefficient</strong>: The negative coefficient on capital stock suggests firms with larger existing capital stock invest less (replacement vs.&nbsp;expansion trade-off)</li>
<li><strong>R²</strong>: The model explains 47.1% of investment variation</li>
</ul>
</section>
<section id="estimate-diamond-match-investment" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="estimate-diamond-match-investment"><span class="header-section-number">4.3</span> Estimate Diamond Match Investment</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>lm.DM <span class="ot">&lt;-</span> <span class="fu">lm</span>(inv <span class="sc">~</span> val <span class="sc">+</span> cap, <span class="at">data =</span> DM.data)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm.DM)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = inv ~ val + cap, data = DM.data)

Residuals:
    Min      1Q  Median      3Q     Max 
-1.5748 -0.5972 -0.3036  0.3834  2.8344 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 0.161519   2.065564   0.078    0.939    
val         0.004573   0.027161   0.168    0.868    
cap         0.437369   0.079589   5.495 3.94e-05 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.085 on 17 degrees of freedom
Multiple R-squared:  0.6432,    Adjusted R-squared:  0.6012 
F-statistic: 15.32 on 2 and 17 DF,  p-value: 0.0001571</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Optional: Show just the OLS models side-by-side using modelsummary</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">modelsummary</span>(</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="st">"US Steel (OLS)"</span> <span class="ot">=</span> lm.US, </span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>       <span class="st">"Diamond Match (OLS)"</span> <span class="ot">=</span> lm.DM),</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">stars =</span> <span class="cn">TRUE</span>,</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">gof_map =</span> <span class="fu">c</span>(<span class="st">"nobs"</span>, <span class="st">"r.squared"</span>, <span class="st">"adj.r.squared"</span>, <span class="st">"rmse"</span>)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<!-- preamble start -->

    <script>

      function styleCell_ip8oxxq2brbugxlytbku(i, j, css_id) {
          var table = document.getElementById("tinytable_ip8oxxq2brbugxlytbku");
          var cell = table.rows[i]?.cells[j];  // Safe navigation to avoid errors
          if (cell) {
              console.log(`Styling cell at (${i}, ${j}) with class ${css_id}`);
              cell.classList.add(css_id);
          } else {
              console.warn(`Cell at (${i}, ${j}) not found.`);
          }
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_ip8oxxq2brbugxlytbku');
        var newRow = table.insertRow(i);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_ip8oxxq2brbugxlytbku(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_ip8oxxq2brbugxlytbku");
        const targetRow = table.rows[i];
        const targetCell = targetRow.cells[j];
        for (let r = 0; r < rowspan; r++) {
          // Only start deleting cells to the right for the first row (r == 0)
          if (r === 0) {
            // Delete cells to the right of the target cell in the first row
            for (let c = colspan - 1; c > 0; c--) {
              if (table.rows[i + r].cells[j + c]) {
                table.rows[i + r].deleteCell(j + c);
              }
            }
          }
          // For rows below the first, delete starting from the target column
          if (r > 0) {
            for (let c = colspan - 1; c >= 0; c--) {
              if (table.rows[i + r] && table.rows[i + r].cells[j]) {
                table.rows[i + r].deleteCell(j);
              }
            }
          }
        }
        // Set rowspan and colspan of the target cell
        targetCell.rowSpan = rowspan;
        targetCell.colSpan = colspan;
      }
      // tinytable span after
      window.addEventListener('load', function () {
          var cellsToStyle = [
            // tinytable style arrays after
          { positions: [ { i: 10, j: 1 }, { i: 10, j: 2 },  ], css_id: 'tinytable_css_a3ap9t4dcadguk4z50lf',}, 
          { positions: [ { i: 6, j: 1 }, { i: 6, j: 2 },  ], css_id: 'tinytable_css_5vv8mxkctm8l0d4jimgb',}, 
          { positions: [ { i: 1, j: 1 }, { i: 2, j: 1 }, { i: 4, j: 1 }, { i: 5, j: 1 }, { i: 3, j: 2 }, { i: 3, j: 1 }, { i: 8, j: 1 }, { i: 9, j: 1 }, { i: 7, j: 2 }, { i: 7, j: 1 }, { i: 1, j: 2 }, { i: 2, j: 2 }, { i: 4, j: 2 }, { i: 5, j: 2 }, { i: 8, j: 2 }, { i: 9, j: 2 },  ], css_id: 'tinytable_css_8lfaqq04kgdo7wfbiykt',}, 
          { positions: [ { i: 0, j: 1 }, { i: 0, j: 2 },  ], css_id: 'tinytable_css_vt0jqndosi90pbgwa278',}, 
          { positions: [ { i: 10, j: 0 },  ], css_id: 'tinytable_css_auzgx34aw4oycnikogie',}, 
          { positions: [ { i: 6, j: 0 },  ], css_id: 'tinytable_css_ewijgyrzd2jdzbr7euzy',}, 
          { positions: [ { i: 1, j: 0 }, { i: 2, j: 0 }, { i: 3, j: 0 }, { i: 4, j: 0 }, { i: 5, j: 0 }, { i: 7, j: 0 }, { i: 8, j: 0 }, { i: 9, j: 0 },  ], css_id: 'tinytable_css_70eb8mibbcyfc7az4p6c',}, 
          { positions: [ { i: 0, j: 0 },  ], css_id: 'tinytable_css_iz2t2e4zi32v8s43tox0',}, 
          ];

          // Loop over the arrays to style the cells
          cellsToStyle.forEach(function (group) {
              group.positions.forEach(function (cell) {
                  styleCell_ip8oxxq2brbugxlytbku(cell.i, cell.j, group.css_id);
              });
          });
      });
    </script>

    <style>
      /* tinytable css entries after */
      .table td.tinytable_css_a3ap9t4dcadguk4z50lf, .table th.tinytable_css_a3ap9t4dcadguk4z50lf { text-align: center; border-bottom: solid #d3d8dc 0.1em; }
      .table td.tinytable_css_5vv8mxkctm8l0d4jimgb, .table th.tinytable_css_5vv8mxkctm8l0d4jimgb { text-align: center; border-bottom: solid black 0.05em; }
      .table td.tinytable_css_8lfaqq04kgdo7wfbiykt, .table th.tinytable_css_8lfaqq04kgdo7wfbiykt { text-align: center; }
      .table td.tinytable_css_vt0jqndosi90pbgwa278, .table th.tinytable_css_vt0jqndosi90pbgwa278 { text-align: center; border-top: solid #d3d8dc 0.1em; border-bottom: solid #d3d8dc 0.05em; }
      .table td.tinytable_css_auzgx34aw4oycnikogie, .table th.tinytable_css_auzgx34aw4oycnikogie { text-align: left; border-bottom: solid #d3d8dc 0.1em; }
      .table td.tinytable_css_ewijgyrzd2jdzbr7euzy, .table th.tinytable_css_ewijgyrzd2jdzbr7euzy { text-align: left; border-bottom: solid black 0.05em; }
      .table td.tinytable_css_70eb8mibbcyfc7az4p6c, .table th.tinytable_css_70eb8mibbcyfc7az4p6c { text-align: left; }
      .table td.tinytable_css_iz2t2e4zi32v8s43tox0, .table th.tinytable_css_iz2t2e4zi32v8s43tox0 { text-align: left; border-top: solid #d3d8dc 0.1em; border-bottom: solid #d3d8dc 0.05em; }
    </style>
    <div class="container">
      <table class="table table-borderless" id="tinytable_ip8oxxq2brbugxlytbku" style="width: auto; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
        
              <tr>
                <th scope="col"> </th>
                <th scope="col">US Steel (OLS)</th>
                <th scope="col">Diamond Match (OLS)</th>
              </tr>
        </thead>
        <tfoot><tr><td colspan="3">+ p &lt; 0.1, * p &lt; 0.05, ** p &lt; 0.01, *** p &lt; 0.001</td></tr></tfoot>
        <tbody>
                <tr>
                  <td>(Intercept)</td>
                  <td>-49.198</td>
                  <td>0.162</td>
                </tr>
                <tr>
                  <td></td>
                  <td>(148.075)</td>
                  <td>(2.066)</td>
                </tr>
                <tr>
                  <td>val</td>
                  <td>0.175*</td>
                  <td>0.005</td>
                </tr>
                <tr>
                  <td></td>
                  <td>(0.074)</td>
                  <td>(0.027)</td>
                </tr>
                <tr>
                  <td>cap</td>
                  <td>0.390*</td>
                  <td>0.437***</td>
                </tr>
                <tr>
                  <td></td>
                  <td>(0.142)</td>
                  <td>(0.080)</td>
                </tr>
                <tr>
                  <td>Num.Obs.</td>
                  <td>20</td>
                  <td>20</td>
                </tr>
                <tr>
                  <td>R2</td>
                  <td>0.471</td>
                  <td>0.643</td>
                </tr>
                <tr>
                  <td>R2 Adj.</td>
                  <td>0.409</td>
                  <td>0.601</td>
                </tr>
                <tr>
                  <td>RMSE</td>
                  <td>88.91</td>
                  <td>1.00</td>
                </tr>
        </tbody>
      </table>
    </div>
<!-- hack to avoid NA insertion in last line -->
</div>
</div>
<p><strong>Interpretation (Diamond Match):</strong></p>
<ul>
<li>The coefficients are quite different from US Steel, suggesting heterogeneous investment behavior</li>
<li>The R² is lower, indicating more unexplained variation in Diamond Match’s investment decisions</li>
</ul>
<hr>
</section>
</section>
<section id="the-case-for-sur-examining-residual-correlation" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> The Case for SUR: Examining Residual Correlation</h1>
<section id="visual-inspection-of-residuals" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="visual-inspection-of-residuals"><span class="header-section-number">5.1</span> Visual Inspection of Residuals</h2>
<p>The key motivation for SUR is the presence of contemporaneously correlated disturbances. Let’s visualize the residuals from our separate OLS regressions:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="co"># US Steel residuals</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>r_US <span class="ot">&lt;-</span> lm.US<span class="sc">$</span>residuals</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(r_US)</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(n, r_US, </span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">type =</span> <span class="st">"b"</span>, </span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">19</span>,</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">"steelblue"</span>,</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"US Steel Residuals"</span>,</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Time Period"</span>, </span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"Residual"</span>)</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">"gray50"</span>)</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">predict</span>(<span class="fu">loess</span>(r_US <span class="sc">~</span> n)), <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Diamond Match residuals</span></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>r_DM <span class="ot">&lt;-</span> lm.DM<span class="sc">$</span>residuals</span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(n, r_DM, </span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>     <span class="at">type =</span> <span class="st">"b"</span>, </span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">19</span>,</span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">"darkgreen"</span>,</span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Diamond Match Residuals"</span>,</span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Time Period"</span>, </span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"Residual"</span>)</span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">"gray50"</span>)</span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">predict</span>(<span class="fu">loess</span>(r_DM <span class="sc">~</span> n)), <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="SUR_examples_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>What do we observe?</strong></p>
<p>The residual patterns show similar movements over time (note the red smoothing lines). Both firms’ residuals are:</p>
<ul>
<li>High in the early periods (pre-WWII)</li>
<li>Dip during the war years</li>
<li>Rise again in the post-war period</li>
</ul>
<p>This suggests common macroeconomic shocks affecting both firms simultaneously.</p>
</section>
<section id="scatter-plot-of-residuals" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="scatter-plot-of-residuals"><span class="header-section-number">5.2</span> Scatter Plot of Residuals</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lm.US<span class="sc">$</span>residuals, lm.DM<span class="sc">$</span>residuals,</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">19</span>,</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">"steelblue"</span>,</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"US Steel Residuals"</span>,</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"Diamond Match Residuals"</span>,</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Residual Correlation Between Firms"</span>)</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">lm</span>(lm.DM<span class="sc">$</span>residuals <span class="sc">~</span> lm.US<span class="sc">$</span>residuals), <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="fu">grid</span>()</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Add correlation</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>corr <span class="ot">&lt;-</span> <span class="fu">cor</span>(lm.US<span class="sc">$</span>residuals, lm.DM<span class="sc">$</span>residuals)</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="fu">min</span>(lm.US<span class="sc">$</span>residuals), </span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>     <span class="at">y =</span> <span class="fu">max</span>(lm.DM<span class="sc">$</span>residuals),</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>     <span class="at">labels =</span> <span class="fu">paste0</span>(<span class="st">"ρ = "</span>, <span class="fu">round</span>(corr, <span class="dv">3</span>)),</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>     <span class="at">pos =</span> <span class="dv">4</span>,</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">"red"</span>,</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>     <span class="at">font =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="SUR_examples_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>A positive correlation confirms our suspicion of contemporaneous dependence!</p>
<hr>
</section>
</section>
<section id="panel-data-configuration" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Panel Data Configuration</h1>
<p>Before using advanced panel estimation methods, we need to configure our data as a panel object, specifying the cross-sectional (firm) and time (year) dimensions.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Configure as panel data</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>my.data <span class="ot">&lt;-</span> <span class="fu">pdata.frame</span>(my.raw.data, <span class="at">index =</span> <span class="fu">c</span>(<span class="st">"firm"</span>, <span class="st">"year"</span>))</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Check the structure</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(my.data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Classes 'pdata.frame' and 'data.frame': 40 obs. of  5 variables:
 $ firm: Factor w/ 2 levels "DM","US": 1 1 1 1 1 1 1 1 1 1 ...
  ..- attr(*, "names")= chr [1:40] "DM-1935" "DM-1936" "DM-1937" "DM-1938" ...
  ..- attr(*, "index")=Classes 'pindex' and 'data.frame':   40 obs. of  2 variables:
  .. ..$ firm: Factor w/ 2 levels "DM","US": 1 1 1 1 1 1 1 1 1 1 ...
  .. ..$ year: Factor w/ 20 levels "1935","1936",..: 1 2 3 4 5 6 7 8 9 10 ...
 $ year: Factor w/ 20 levels "1935","1936",..: 1 2 3 4 5 6 7 8 9 10 ...
  ..- attr(*, "names")= chr [1:40] "DM-1935" "DM-1936" "DM-1937" "DM-1938" ...
  ..- attr(*, "index")=Classes 'pindex' and 'data.frame':   40 obs. of  2 variables:
  .. ..$ firm: Factor w/ 2 levels "DM","US": 1 1 1 1 1 1 1 1 1 1 ...
  .. ..$ year: Factor w/ 20 levels "1935","1936",..: 1 2 3 4 5 6 7 8 9 10 ...
 $ inv : 'pseries' Named num  2.54 2 2.19 1.99 2.03 1.81 2.14 1.86 0.93 1.18 ...
  ..- attr(*, "names")= chr [1:40] "DM-1935" "DM-1936" "DM-1937" "DM-1938" ...
  ..- attr(*, "index")=Classes 'pindex' and 'data.frame':   40 obs. of  2 variables:
  .. ..$ firm: Factor w/ 2 levels "DM","US": 1 1 1 1 1 1 1 1 1 1 ...
  .. ..$ year: Factor w/ 20 levels "1935","1936",..: 1 2 3 4 5 6 7 8 9 10 ...
 $ val : 'pseries' Named num  70.9 87.9 82.2 58.7 80.5 ...
  ..- attr(*, "names")= chr [1:40] "DM-1935" "DM-1936" "DM-1937" "DM-1938" ...
  ..- attr(*, "index")=Classes 'pindex' and 'data.frame':   40 obs. of  2 variables:
  .. ..$ firm: Factor w/ 2 levels "DM","US": 1 1 1 1 1 1 1 1 1 1 ...
  .. ..$ year: Factor w/ 20 levels "1935","1936",..: 1 2 3 4 5 6 7 8 9 10 ...
 $ cap : 'pseries' Named num  4.5 4.71 4.57 4.56 4.38 4.21 4.12 3.83 3.58 3.41 ...
  ..- attr(*, "names")= chr [1:40] "DM-1935" "DM-1936" "DM-1937" "DM-1938" ...
  ..- attr(*, "index")=Classes 'pindex' and 'data.frame':   40 obs. of  2 variables:
  .. ..$ firm: Factor w/ 2 levels "DM","US": 1 1 1 1 1 1 1 1 1 1 ...
  .. ..$ year: Factor w/ 20 levels "1935","1936",..: 1 2 3 4 5 6 7 8 9 10 ...
 - attr(*, "index")=Classes 'pindex' and 'data.frame':  40 obs. of  2 variables:
  ..$ firm: Factor w/ 2 levels "DM","US": 1 1 1 1 1 1 1 1 1 1 ...
  ..$ year: Factor w/ 20 levels "1935","1936",..: 1 2 3 4 5 6 7 8 9 10 ...</code></pre>
</div>
</div>
<hr>
</section>
<section id="alternative-methods-for-equation-by-equation-estimation" class="level1" data-number="7">
<h1 data-number="7"><span class="header-section-number">7</span> Alternative Methods for Equation-by-Equation Estimation</h1>
<section id="using-plm-package" class="level2" data-number="7.1">
<h2 data-number="7.1" class="anchored" data-anchor-id="using-plm-package"><span class="header-section-number">7.1</span> Using PLM Package</h2>
<p>The <code>pvcm()</code> function (Panel Variable Coefficients Model) estimates separate equations for each panel unit:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>myOLS.pvcm <span class="ot">&lt;-</span> <span class="fu">pvcm</span>(inv <span class="sc">~</span> val <span class="sc">+</span> cap, </span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> my.data, </span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">model =</span> <span class="st">"within"</span>)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">coef</span>(myOLS.pvcm))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   (Intercept)         val       cap
DM   0.1615186 0.004573432 0.4373692
US -49.1983219 0.174856015 0.3896419</code></pre>
</div>
</div>
<p><strong>Note:</strong> The <code>pvcm()</code> object doesn’t easily provide standard errors for individual coefficients. For full coefficient information including standard errors, use <code>systemfit()</code> (shown below) or the individual <code>lm()</code> models we estimated earlier.</p>
</section>
<section id="using-systemfit-package" class="level2" data-number="7.2">
<h2 data-number="7.2" class="anchored" data-anchor-id="using-systemfit-package"><span class="header-section-number">7.2</span> Using SYSTEMFIT Package</h2>
<p>The <code>systemfit()</code> function with <code>method = "OLS"</code> gives the same results:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>myOLS.sysfit <span class="ot">&lt;-</span> <span class="fu">systemfit</span>(inv <span class="sc">~</span> val <span class="sc">+</span> cap, </span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>                           <span class="at">method =</span> <span class="st">"OLS"</span>, </span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>                           <span class="at">data =</span> my.data)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Display coefficients in a formatted table</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>(myOLS.sysfit)<span class="sc">$</span>coefficients,</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">digits =</span> <span class="dv">4</span>,</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">caption =</span> <span class="st">"OLS Estimates by Equation"</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>OLS Estimates by Equation</caption>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">Estimate</th>
<th style="text-align: right;">Std. Error</th>
<th style="text-align: right;">t value</th>
<th style="text-align: right;">Pr(&gt;|t|)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">DM_(Intercept)</td>
<td style="text-align: right;">0.1615</td>
<td style="text-align: right;">2.0656</td>
<td style="text-align: right;">0.0782</td>
<td style="text-align: right;">0.9386</td>
</tr>
<tr class="even">
<td style="text-align: left;">DM_val</td>
<td style="text-align: right;">0.0046</td>
<td style="text-align: right;">0.0272</td>
<td style="text-align: right;">0.1684</td>
<td style="text-align: right;">0.8683</td>
</tr>
<tr class="odd">
<td style="text-align: left;">DM_cap</td>
<td style="text-align: right;">0.4374</td>
<td style="text-align: right;">0.0796</td>
<td style="text-align: right;">5.4954</td>
<td style="text-align: right;">0.0000</td>
</tr>
<tr class="even">
<td style="text-align: left;">US_(Intercept)</td>
<td style="text-align: right;">-49.1983</td>
<td style="text-align: right;">148.0754</td>
<td style="text-align: right;">-0.3323</td>
<td style="text-align: right;">0.7438</td>
</tr>
<tr class="odd">
<td style="text-align: left;">US_val</td>
<td style="text-align: right;">0.1749</td>
<td style="text-align: right;">0.0742</td>
<td style="text-align: right;">2.3566</td>
<td style="text-align: right;">0.0307</td>
</tr>
<tr class="even">
<td style="text-align: left;">US_cap</td>
<td style="text-align: right;">0.3896</td>
<td style="text-align: right;">0.1424</td>
<td style="text-align: right;">2.7369</td>
<td style="text-align: right;">0.0140</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="manual-calculation-understanding-the-math" class="level2" data-number="7.3">
<h2 data-number="7.3" class="anchored" data-anchor-id="manual-calculation-understanding-the-math"><span class="header-section-number">7.3</span> Manual Calculation: Understanding the Math</h2>
<p>To understand what’s happening under the hood, let’s calculate the OLS coefficients manually. This reveals the block-diagonal structure of the SUR design matrix:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Construct design matrix for US Steel (top block)</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>X1 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="dv">1</span>, US.data<span class="sc">$</span>val, US.data<span class="sc">$</span>cap, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Construct design matrix for Diamond Match (bottom block)</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>X2 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, DM.data<span class="sc">$</span>val, DM.data<span class="sc">$</span>cap)</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Stack the blocks</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">rbind</span>(X1, X2)</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Stack the dependent variables</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> my.raw.data<span class="sc">$</span>inv</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a><span class="co"># OLS formula: β = (X'X)^(-1) X'y</span></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>betas.ols <span class="ot">&lt;-</span> <span class="fu">solve</span>(<span class="fu">t</span>(X) <span class="sc">%*%</span> X) <span class="sc">%*%</span> <span class="fu">t</span>(X) <span class="sc">%*%</span> y</span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Manually calculated OLS coefficients:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Manually calculated OLS coefficients:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(betas.ols)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              [,1]
[1,] -49.198321862
[2,]   0.174856015
[3,]   0.389641889
[4,]   0.161518567
[5,]   0.004573432
[6,]   0.437369190</code></pre>
</div>
</div>
<p><strong>The Structure:</strong> Note how the design matrix has a block-diagonal structure where:</p>
<ul>
<li>First 3 columns (and rows 1-20) relate to US Steel</li>
<li>Last 3 columns (and rows 21-40) relate to Diamond Match</li>
<li>Zeros ensure each firm’s coefficients are estimated independently</li>
</ul>
<hr>
</section>
</section>
<section id="testing-for-cross-sectional-dependence" class="level1" data-number="8">
<h1 data-number="8"><span class="header-section-number">8</span> Testing for Cross-Sectional Dependence</h1>
<p>Before applying SUR, we should formally test whether cross-sectional dependence exists.</p>
<section id="examining-the-covariance-matrix" class="level2" data-number="8.1">
<h2 data-number="8.1" class="anchored" data-anchor-id="examining-the-covariance-matrix"><span class="header-section-number">8.1</span> Examining the Covariance Matrix</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Residual covariance matrix</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Residual Covariance Matrix (Σ):</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Residual Covariance Matrix (Σ):</code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">summary</span>(myOLS.sysfit)<span class="sc">$</span>residCov)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          DM         US
DM  1.178043   73.45838
US 73.458384 9299.60405</code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Residual Correlation Matrix:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Residual Correlation Matrix:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">summary</span>(myOLS.sysfit)<span class="sc">$</span>residCor)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          DM        US
DM 1.0000000 0.7018245
US 0.7018245 1.0000000</code></pre>
</div>
</div>
<p>The covariance (73.46) and correlation (0.702) between residuals are both positive and substantial.</p>
</section>
<section id="kronecker-product-and-full-error-covariance" class="level2" data-number="8.2">
<h2 data-number="8.2" class="anchored" data-anchor-id="kronecker-product-and-full-error-covariance"><span class="header-section-number">8.2</span> Kronecker Product and Full Error Covariance</h2>
<p>For SUR, we assume the full error covariance matrix <span class="math inline">\(\Omega\)</span> has a Kronecker product structure:</p>
<p><span class="math display">\[\Omega = \Sigma \otimes I_T\]</span></p>
<p>where <span class="math inline">\(\Sigma\)</span> is the <span class="math inline">\(M \times M\)</span> contemporaneous covariance matrix and <span class="math inline">\(I_T\)</span> is a <span class="math inline">\(T \times T\)</span> identity matrix.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">nrow</span>(DM.data)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>sigma_hat <span class="ot">&lt;-</span> <span class="fu">summary</span>(myOLS.sysfit)<span class="sc">$</span>residCov</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>omega_hat <span class="ot">&lt;-</span> sigma_hat <span class="sc">%x%</span> <span class="fu">diag</span>(N)  <span class="co"># Kronecker product</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>  omega_hat,</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">format =</span> <span class="st">"pipe"</span>,</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">digits =</span> <span class="dv">1</span>,</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">caption =</span> <span class="st">"Table 2: Estimated Error Covariance Matrix"</span></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Table 2: Estimated Error Covariance Matrix</caption>
<colgroup>
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
</colgroup>
<tbody>
<tr class="odd">
<td style="text-align: right;">1.2</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">73.5</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">1.2</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">73.5</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">1.2</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">73.5</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">1.2</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">73.5</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">1.2</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">73.5</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">1.2</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">73.5</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">1.2</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">73.5</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">1.2</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">73.5</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">1.2</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">73.5</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">1.2</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">73.5</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">1.2</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">73.5</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">1.2</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">73.5</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">1.2</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">73.5</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">1.2</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">73.5</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">1.2</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">73.5</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">1.2</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">73.5</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">1.2</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">73.5</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">1.2</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">73.5</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">1.2</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">73.5</td>
<td style="text-align: right;">0.0</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">1.2</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">73.5</td>
</tr>
<tr class="odd">
<td style="text-align: right;">73.5</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">9299.6</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">73.5</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">9299.6</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">73.5</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">9299.6</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">73.5</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">9299.6</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">73.5</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">9299.6</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">73.5</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">9299.6</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">73.5</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">9299.6</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">73.5</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">9299.6</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">73.5</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">9299.6</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">73.5</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">9299.6</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">73.5</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">9299.6</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">73.5</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">9299.6</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">73.5</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">9299.6</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">73.5</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">9299.6</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">73.5</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">9299.6</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">73.5</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">9299.6</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">73.5</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">9299.6</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">73.5</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">9299.6</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">73.5</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">9299.6</td>
<td style="text-align: right;">0.0</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">73.5</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">9299.6</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="formal-tests-for-cross-sectional-dependence" class="level2" data-number="8.3">
<h2 data-number="8.3" class="anchored" data-anchor-id="formal-tests-for-cross-sectional-dependence"><span class="header-section-number">8.3</span> Formal Tests for Cross-Sectional Dependence</h2>
<section id="breusch-pagan-lm-test" class="level3" data-number="8.3.1">
<h3 data-number="8.3.1" class="anchored" data-anchor-id="breusch-pagan-lm-test"><span class="header-section-number">8.3.1</span> Breusch-Pagan LM Test</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pcdtest</span>(myOLS.pvcm, <span class="at">test =</span> <span class="st">"lm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Breusch-Pagan LM test for cross-sectional dependence in panels

data:  NULL
chisq = 9.8512, df = 1, p-value = 0.001697
alternative hypothesis: cross-sectional dependence</code></pre>
</div>
</div>
<p><strong>Interpretation:</strong> The null hypothesis is “no cross-sectional dependence.” The very small p-value means we reject the null—there IS significant cross-sectional dependence.</p>
</section>
<section id="pesaran-cd-test" class="level3" data-number="8.3.2">
<h3 data-number="8.3.2" class="anchored" data-anchor-id="pesaran-cd-test"><span class="header-section-number">8.3.2</span> Pesaran CD Test</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pcdtest</span>(myOLS.pvcm, <span class="at">test =</span> <span class="st">"cd"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pesaran CD test for cross-sectional dependence in panels

data:  NULL
z = 3.1387, p-value = 0.001697
alternative hypothesis: cross-sectional dependence</code></pre>
</div>
</div>
<p><strong>Interpretation:</strong> This test also strongly rejects the null of no cross-sectional dependence.</p>
<p><strong>Conclusion:</strong> Both tests confirm significant contemporaneous correlation. SUR estimation is justified!</p>
<hr>
</section>
</section>
</section>
<section id="seemingly-unrelated-regression-sur-estimation" class="level1" data-number="9">
<h1 data-number="9"><span class="header-section-number">9</span> Seemingly Unrelated Regression (SUR) Estimation</h1>
<p>Now we’re ready to estimate the system using the SUR method, which accounts for the cross-equation correlation.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>mySUR.sysfit <span class="ot">&lt;-</span> <span class="fu">systemfit</span>(inv <span class="sc">~</span> val <span class="sc">+</span> cap, </span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>                           <span class="at">method =</span> <span class="st">"SUR"</span>, </span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>                           <span class="at">data =</span> my.data)</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Display SUR estimates in a formatted table</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>(mySUR.sysfit)<span class="sc">$</span>coefficients,</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">digits =</span> <span class="dv">4</span>,</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">caption =</span> <span class="st">"SUR Estimates"</span></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>SUR Estimates</caption>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">Estimate</th>
<th style="text-align: right;">Std. Error</th>
<th style="text-align: right;">t value</th>
<th style="text-align: right;">Pr(&gt;|t|)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">DM_(Intercept)</td>
<td style="text-align: right;">1.4540</td>
<td style="text-align: right;">1.5516</td>
<td style="text-align: right;">0.9371</td>
<td style="text-align: right;">0.3618</td>
</tr>
<tr class="even">
<td style="text-align: left;">DM_val</td>
<td style="text-align: right;">-0.0065</td>
<td style="text-align: right;">0.0210</td>
<td style="text-align: right;">-0.3110</td>
<td style="text-align: right;">0.7596</td>
</tr>
<tr class="odd">
<td style="text-align: left;">DM_cap</td>
<td style="text-align: right;">0.3525</td>
<td style="text-align: right;">0.0689</td>
<td style="text-align: right;">5.1193</td>
<td style="text-align: right;">0.0001</td>
</tr>
<tr class="even">
<td style="text-align: left;">US_(Intercept)</td>
<td style="text-align: right;">-97.3600</td>
<td style="text-align: right;">110.4003</td>
<td style="text-align: right;">-0.8819</td>
<td style="text-align: right;">0.3901</td>
</tr>
<tr class="odd">
<td style="text-align: left;">US_val</td>
<td style="text-align: right;">0.2131</td>
<td style="text-align: right;">0.0554</td>
<td style="text-align: right;">3.8456</td>
<td style="text-align: right;">0.0013</td>
</tr>
<tr class="even">
<td style="text-align: left;">US_cap</td>
<td style="text-align: right;">0.2971</td>
<td style="text-align: right;">0.1305</td>
<td style="text-align: right;">2.2762</td>
<td style="text-align: right;">0.0361</td>
</tr>
</tbody>
</table>
</div>
</div>
<section id="comparing-ols-vs-sur-results" class="level2" data-number="9.1">
<h2 data-number="9.1" class="anchored" data-anchor-id="comparing-ols-vs-sur-results"><span class="header-section-number">9.1</span> Comparing OLS vs SUR Results</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract coefficients and standard errors for easier comparison</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>ols_us <span class="ot">&lt;-</span> <span class="fu">summary</span>(lm.US)<span class="sc">$</span>coefficients</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>ols_dm <span class="ot">&lt;-</span> <span class="fu">summary</span>(lm.DM)<span class="sc">$</span>coefficients</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>sur_all <span class="ot">&lt;-</span> <span class="fu">summary</span>(mySUR.sysfit)<span class="sc">$</span>coefficients</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Create side-by-side comparison for US Steel</span></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"US Steel: OLS vs SUR</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>US Steel: OLS vs SUR</code></pre>
</div>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>us_comparison <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">Coefficient =</span> <span class="fu">rownames</span>(ols_us),</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">OLS_Est =</span> ols_us[, <span class="st">"Estimate"</span>],</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">OLS_SE =</span> ols_us[, <span class="st">"Std. Error"</span>],</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">SUR_Est =</span> sur_all[<span class="dv">4</span><span class="sc">:</span><span class="dv">6</span>, <span class="st">"Estimate"</span>],  <span class="co"># US is rows 4-6 (alphabetically after DM)</span></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">SUR_SE =</span> sur_all[<span class="dv">4</span><span class="sc">:</span><span class="dv">6</span>, <span class="st">"Std. Error"</span>]</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(us_comparison, <span class="at">digits =</span> <span class="dv">4</span>, <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Coefficient</th>
<th style="text-align: right;">OLS_Est</th>
<th style="text-align: right;">OLS_SE</th>
<th style="text-align: right;">SUR_Est</th>
<th style="text-align: right;">SUR_SE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">-49.1983</td>
<td style="text-align: right;">148.0754</td>
<td style="text-align: right;">-97.3600</td>
<td style="text-align: right;">110.4003</td>
</tr>
<tr class="even">
<td style="text-align: left;">val</td>
<td style="text-align: right;">0.1749</td>
<td style="text-align: right;">0.0742</td>
<td style="text-align: right;">0.2131</td>
<td style="text-align: right;">0.0554</td>
</tr>
<tr class="odd">
<td style="text-align: left;">cap</td>
<td style="text-align: right;">0.3896</td>
<td style="text-align: right;">0.1424</td>
<td style="text-align: right;">0.2971</td>
<td style="text-align: right;">0.1305</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create side-by-side comparison for Diamond Match</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Diamond Match: OLS vs SUR</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Diamond Match: OLS vs SUR</code></pre>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>dm_comparison <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">Coefficient =</span> <span class="fu">rownames</span>(ols_dm),</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">OLS_Est =</span> ols_dm[, <span class="st">"Estimate"</span>],</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">OLS_SE =</span> ols_dm[, <span class="st">"Std. Error"</span>],</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">SUR_Est =</span> sur_all[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="st">"Estimate"</span>],  <span class="co"># DM is rows 1-3 (alphabetically first)</span></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">SUR_SE =</span> sur_all[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="st">"Std. Error"</span>]</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(dm_comparison, <span class="at">digits =</span> <span class="dv">4</span>, <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Coefficient</th>
<th style="text-align: right;">OLS_Est</th>
<th style="text-align: right;">OLS_SE</th>
<th style="text-align: right;">SUR_Est</th>
<th style="text-align: right;">SUR_SE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">0.1615</td>
<td style="text-align: right;">2.0656</td>
<td style="text-align: right;">1.4540</td>
<td style="text-align: right;">1.5516</td>
</tr>
<tr class="even">
<td style="text-align: left;">val</td>
<td style="text-align: right;">0.0046</td>
<td style="text-align: right;">0.0272</td>
<td style="text-align: right;">-0.0065</td>
<td style="text-align: right;">0.0210</td>
</tr>
<tr class="odd">
<td style="text-align: left;">cap</td>
<td style="text-align: right;">0.4374</td>
<td style="text-align: right;">0.0796</td>
<td style="text-align: right;">0.3525</td>
<td style="text-align: right;">0.0689</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="efficiency-gains" class="level2" data-number="9.2">
<h2 data-number="9.2" class="anchored" data-anchor-id="efficiency-gains"><span class="header-section-number">9.2</span> Efficiency Gains</h2>
<p><strong>Key observations from the comparison tables above:</strong></p>
<ol type="1">
<li><strong>Coefficient estimates</strong> are very similar between OLS and SUR (both are consistent)
<ul>
<li>Point estimates remain nearly identical</li>
<li>This confirms both methods are unbiased under our assumptions</li>
</ul></li>
<li><strong>Standard errors</strong> are slightly smaller for SUR (efficiency improvement)
<ul>
<li>Compare <code>OLS_SE</code> vs <code>SUR_SE</code> columns in each table</li>
<li>The reduction in standard errors means tighter confidence intervals</li>
<li>More efficient inference (more powerful hypothesis tests)</li>
</ul></li>
<li>The efficiency gains are modest in this example because:
<ul>
<li>Sample size is relatively small (20 observations per equation)</li>
<li>Cross-equation correlation is moderate (ρ ≈ 0.702)</li>
<li>Regressors are similar across equations</li>
</ul></li>
</ol>
<p><strong>Rule of thumb:</strong> SUR gains are largest when:</p>
<ul>
<li>Cross-equation correlation is high (|ρ| &gt; 0.5)</li>
<li>Sample size is moderate to large</li>
<li>Regressors differ substantially across equations</li>
<li>Number of equations (M) is larger</li>
</ul>
<hr>
</section>
</section>
<section id="testing-for-coefficient-homogeneity" class="level1" data-number="10">
<h1 data-number="10"><span class="header-section-number">10</span> Testing for Coefficient Homogeneity</h1>
<p>An important question: Can we pool the data across firms, or do we need firm-specific coefficients?</p>
<section id="pooled-ols-model" class="level2" data-number="10.1">
<h2 data-number="10.1" class="anchored" data-anchor-id="pooled-ols-model"><span class="header-section-number">10.1</span> Pooled OLS Model</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>my.Pooled.model <span class="ot">&lt;-</span> <span class="fu">plm</span>(inv <span class="sc">~</span> val <span class="sc">+</span> cap, </span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>                        <span class="at">data =</span> my.data, </span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>                        <span class="at">model =</span> <span class="st">"pooling"</span>)</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Display pooled estimates in a formatted table</span></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>(my.Pooled.model)<span class="sc">$</span>coefficients,</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">digits =</span> <span class="dv">4</span>,</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">caption =</span> <span class="st">"Pooled OLS Estimates"</span></span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Pooled OLS Estimates</caption>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">Estimate</th>
<th style="text-align: right;">Std. Error</th>
<th style="text-align: right;">t-value</th>
<th style="text-align: right;">Pr(&gt;|t|)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">-11.1476</td>
<td style="text-align: right;">15.0182</td>
<td style="text-align: right;">-0.7423</td>
<td style="text-align: right;">0.4626</td>
</tr>
<tr class="even">
<td style="text-align: left;">val</td>
<td style="text-align: right;">0.1568</td>
<td style="text-align: right;">0.0177</td>
<td style="text-align: right;">8.8403</td>
<td style="text-align: right;">0.0000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">cap</td>
<td style="text-align: right;">0.3843</td>
<td style="text-align: right;">0.0956</td>
<td style="text-align: right;">4.0192</td>
<td style="text-align: right;">0.0003</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="chow-test-for-poolability" class="level2" data-number="10.2">
<h2 data-number="10.2" class="anchored" data-anchor-id="chow-test-for-poolability"><span class="header-section-number">10.2</span> Chow Test for Poolability</h2>
<p>The pooltest() performs a Chow test to see if coefficients differ across firms:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pooltest</span>(my.Pooled.model, myOLS.pvcm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    F statistic

data:  inv ~ val + cap
F = 0.047853, df1 = 3, df2 = 34, p-value = 0.9859
alternative hypothesis: unstability</code></pre>
</div>
</div>
<p><strong>Interpretation:</strong></p>
<ul>
<li><strong>Null hypothesis</strong>: Coefficients are homogeneous across firms (pooling is appropriate)</li>
<li><strong>P-value</strong>: 0.9859</li>
<li><strong>Decision</strong>: We cannot reject the null hypothesis at conventional significance levels</li>
</ul>
<p><strong>Implication:</strong> While firms appear to have different coefficients, the differences are not statistically significant. We could justify using a pooled model, though the firm-specific models provide richer insights.</p>
<hr>
</section>
</section>
<section id="summary-and-key-takeaways" class="level1" data-number="11">
<h1 data-number="11"><span class="header-section-number">11</span> Summary and Key Takeaways</h1>
<section id="what-we-learned" class="level2" data-number="11.1">
<h2 data-number="11.1" class="anchored" data-anchor-id="what-we-learned"><span class="header-section-number">11.1</span> What We Learned</h2>
<ol type="1">
<li><strong>SUR exploits cross-equation correlation</strong> in error terms to improve estimation efficiency</li>
<li><strong>The Grunfeld dataset</strong> demonstrates how common macroeconomic shocks can create contemporaneous correlation across firms</li>
<li><strong>Testing is crucial</strong>: Always test for cross-sectional dependence before applying SUR</li>
<li><strong>Efficiency gains vary</strong>: In our example, gains were modest but noticeable</li>
</ol>
</section>
<section id="when-to-use-sur-vs-alternatives" class="level2" data-number="11.2">
<h2 data-number="11.2" class="anchored" data-anchor-id="when-to-use-sur-vs-alternatives"><span class="header-section-number">11.2</span> When to Use SUR vs Alternatives</h2>
<p><strong>Use SUR when:</strong></p>
<ul>
<li>You have multiple related equations</li>
<li>Errors are likely correlated contemporaneously</li>
<li>You want more efficient estimates than OLS</li>
<li>Cross-sectional dependence tests are significant</li>
</ul>
<p><strong>Consider alternatives (to be discussed later in the semester):</strong></p>
<ul>
<li><strong>Pooled OLS</strong>: When coefficients are truly homogeneous (after testing)</li>
<li><strong>Fixed Effects</strong>: When you need to control for time-invariant heterogeneity</li>
<li><strong>Random Effects</strong>: When panel-specific effects are uncorrelated with regressors</li>
<li><strong>3SLS</strong>: When you have endogeneity in addition to cross-equation correlation</li>
</ul>
</section>
<section id="the-sur-advantage" class="level2" data-number="11.3">
<h2 data-number="11.3" class="anchored" data-anchor-id="the-sur-advantage"><span class="header-section-number">11.3</span> The SUR Advantage</h2>
<p>While coefficient estimates are consistent whether you use OLS or SUR, SUR provides:</p>
<ul>
<li>Lower standard errors (more precise estimates)<br>
</li>
<li>More efficient inference (narrower confidence intervals)<br>
</li>
<li>Better utilization of information in the data<br>
</li>
<li>More powerful hypothesis tests</li>
</ul>
</section>
<section id="practical-recommendations" class="level2" data-number="11.4">
<h2 data-number="11.4" class="anchored" data-anchor-id="practical-recommendations"><span class="header-section-number">11.4</span> Practical Recommendations</h2>
<ol type="1">
<li><strong>Always visualize residuals</strong> to check for patterns</li>
<li><strong>Run formal tests</strong> for cross-sectional dependence</li>
<li><strong>Compare OLS and SUR results</strong> to assess efficiency gains</li>
<li><strong>Test coefficient homogeneity</strong> to see if pooling is justified</li>
<li><strong>Consider your research question</strong>: Do you need firm-specific coefficients or pooled effects?</li>
</ol>
<hr>
</section>
</section>
<section id="further-reading-and-resources" class="level1" data-number="12">
<h1 data-number="12"><span class="header-section-number">12</span> Further Reading and Resources</h1>
<p><strong>Classic Papers:</strong></p>
<ul>
<li>Zellner, A. (1962). “An Efficient Method of Estimating Seemingly Unrelated Regressions and Tests for Aggregation Bias.” <em>Journal of the American Statistical Association</em>, 57(298), 348-368.</li>
<li>Grunfeld, Y. (1958). <em>The Determinants of Corporate Investment.</em> PhD Thesis, University of Chicago.</li>
</ul>
<p><strong>Modern Treatments:</strong></p>
<ul>
<li>Greene, W. H. (2018). <em>Econometric Analysis</em> (8th ed.). Pearson. (Chapter 10)</li>
<li>Wooldridge, J. M. (2010). <em>Econometric Analysis of Cross Section and Panel Data</em> (2nd ed.). MIT Press.</li>
</ul>
<p><strong>R Resources:</strong></p>
<ul>
<li><a href="https://cran.r-project.org/web/packages/plm/plm.pdf">PLM package documentation</a></li>
<li><a href="https://cran.r-project.org/web/packages/systemfit/systemfit.pdf">systemfit package documentation</a></li>
</ul>
<hr>
<p><strong>End of Lecture Notes</strong></p>
<p><em>These notes were prepared for educational purposes. Questions and feedback are welcome!</em></p>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>